From c81d268c8d661d3acb7f3a7197ab922569ac21d7 Mon Sep 17 00:00:00 2001
From: Joseph Liu <kwliu@nuvoton.com>
Date: Mon, 23 Sep 2019 18:57:49 +0800
Subject: [PATCH 10/34] dts: nuvoton: add nuvotn runbmc olympus support

Signed-off-by: Joseph Liu <kwliu@nuvoton.com>
---
 ...nuvoton-npcm750-runbmc-olympus-pincfg.dtsi |  5 ++
 .../dts/nuvoton-npcm750-runbmc-olympus.dts    | 53 ++++++++-----------
 2 files changed, 27 insertions(+), 31 deletions(-)

diff --git a/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus-pincfg.dtsi b/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus-pincfg.dtsi
index 230cb344b2e1..f3390dd711c8 100644
--- a/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus-pincfg.dtsi
+++ b/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus-pincfg.dtsi
@@ -388,6 +388,11 @@
 			bias-disable;
 			input-enable;
 		};
+		gpio192o_pins: gpio192o-pins {
+			pins = "GPIO192";
+			bias-disable;
+			output-high;
+		};
 		gpio196_pins: gpio196-pins {
 			pins = "GPIO196/SMB0CSCL";
 			bias-disable;
diff --git a/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus.dts b/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus.dts
index 71b384676301..dbc95873cc5d 100644
--- a/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus.dts
+++ b/arch/arm/boot/dts/nuvoton-npcm750-runbmc-olympus.dts
@@ -62,6 +62,25 @@
 			<&adc 4>, <&adc 5>, <&adc 6>, <&adc 7>;
 	};
 
+	jtag_master {
+		compatible = "nuvoton,npcm750-jtag-master";
+		#address-cells = <1>;
+		#size-cells = <1>;
+
+		pspi-controller = <2>; /* pspi2 */
+		reg = <0xf0201000 0x1000>;
+		interrupts = <GIC_SPI 28 IRQ_TYPE_LEVEL_HIGH>;
+		clocks = <&clk NPCM7XX_CLK_APB5>;
+
+		jtag-gpios = <&gpio0 19 GPIO_ACTIVE_HIGH>, /* TCK */
+				<&gpio0 18 GPIO_ACTIVE_HIGH>, /* TDI */
+				<&gpio0 17 GPIO_ACTIVE_HIGH>, /* TDO */
+				<&gpio0 16 GPIO_ACTIVE_HIGH>; /* TMS */
+		jtag-gpios-reg = <0xf0010000 0xf0010000
+						  0xf0010000 0xf0010000>;
+		status = "okay";
+	};
+
 	ahb {
 		gmac0: eth@f0802000 {
 			phy-mode = "rgmii-id";
@@ -208,8 +227,8 @@
 					#address-cells = <1>;
 					#size-cells = <1>;
 					system1@0 {
-						label = "spi3-system1";
-						reg = <0x0 0x800000>;
+						label = "bios";
+						reg = <0x0 0x0>;
 					};
 					system2@800000 {
 						label = "spi3-system2";
@@ -395,7 +414,7 @@
 					reg = <0x4c>;
 				};
 				power-supply@58 {
-					compatible = "delta,dps800";
+					compatible = "pmbus";
 					reg = <0x58>;
 				};
 			};
@@ -527,7 +546,6 @@
 				gpio: pca9555@27 {
 					compatible = "nxp,pca9555";
 					reg = <0x27>;
-
 					gpio-controller;
 					#gpio-cells = <2>;
 				};
@@ -1157,33 +1175,6 @@
 		};
 	};
 
-	jtag {
-		compatible = "nuvoton,npcm750-jtag";
-		enable_pspi_jtag = <1>;
-		pspi-index = <2>;
-		tck {
-			label = "tck";
-			gpios = <&gpio0 19 0>; /* gpio19 */
-			regbase = <0xf0010000 0x1000>;
-		};
-
-		tdi {
-			label = "tdi";
-			gpios = <&gpio0 18 0>; /* gpio18 */
-			regbase = <0xf0010000 0x1000>;
-		};
-
-		tdo {
-			label = "tdo";
-			gpios = <&gpio0 17 0>; /* gpio17 */
-			regbase = <0xf0010000 0x1000>;
-		};
-		tms {
-			label = "tms";
-			gpios = <&gpio0 16 0>; /* gpio16 */
-			regbase = <0xf0010000 0x1000>;
-		};
-	};
 };
 
 &gcr {
-- 
2.17.1

